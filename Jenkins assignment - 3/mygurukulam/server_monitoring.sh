#!/bin/bash

# рд╕рд░реНрд╡рд░ рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ рд╕реНрдХреНрд░рд┐рдкреНрдЯ
# рджрд┐рдирд╛рдВрдХ: 2025-01-23

# рд╕рд░реНрд╡рд░ рдЕрдкрдЯрд╛рдЗрдо рдХреЛ uptime.log рдлрд╛рдЗрд▓ рдореЗрдВ рд╕реЗрд╡ рдХрд░реЗрдВрдЧреЗ
uptime > uptime.log

# рдЯреЙрдк 5 рдкреНрд░реЛрд╕реЗрд╕реЗрд╕ рдХреЛ top.log рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд░реЗрдВрдЧреЗ
top -b -n 1 | head -n 5 > top.log

# рдбрд┐рд╕реНрдХ рдЙрдкрдпреЛрдЧ рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ df.log рдореЗрдВ
df -h > df.log

# рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд┐рдХ рдкреИрдХреЗрдЯреНрд╕ рдХреЛ netstat.log рдореЗрдВ
netstat -s | grep -i "Packets:received" > netstat.log

# рдЕрдкрдЯрд╛рдЗрдо рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ рджрд┐рдЦрд╛рдЗрдП
echo "-------------------------"
echo "ЁЯХТ рд╕рд░реНрд╡рд░ рдЕрдкрдЯрд╛рдЗрдо:"
cat uptime.log

# рдЯреЙрдк рдкреНрд░реЛрд╕реЗрд╕реЗрд╕ рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ
echo "-------------------------"
echo "ЁЯФе рдЯреЙрдк 5 рдкреНрд░реЛрд╕реЗрд╕реЗрд╕:"
cat top.log

# рдбрд┐рд╕реНрдХ рдЙрдкрдпреЛрдЧ рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ
echo "-------------------------"
echo "ЁЯТ╛ рдбрд┐рд╕реНрдХ рдЙрдкрдпреЛрдЧ:"
cat df.log

# рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд┐рдХ рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ
echo "-------------------------"
echo "ЁЯМР рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд┐рдХ:"
cat netstat.log

# рдореЗрдореЛрд░реА рдЙрдкрдпреЛрдЧ
echo "-------------------------"
echo "ЁЯза рдореЗрдореЛрд░реА рдЙрдкрдпреЛрдЧ:"
free -h | awk '/^Mem/ {print "Used: " $3 " / Total: " $2}'

# CPU рдЬрд╛рдирдХрд╛рд░реА
echo "-------------------------"
echo "тЪЩя╕П CPU рдЬрд╛рдирдХрд╛рд░реА:"
lscpu | grep -E '^(Model name|CPU\(s\):|Thread\(s\) per core:|Core\(s\) per socket:)'

# рд╡рд┐рд╕реНрддреГрдд рд░рдирд┐рдВрдЧ рдкреНрд░реЛрд╕реЗрд╕реЗрд╕
echo "-------------------------"
echo "ЁЯУЛ рд╡рд┐рд╕реНрддреГрдд рд░рдирд┐рдВрдЧ рдкреНрд░реЛрд╕реЗрд╕реЗрд╕:"
ps aux --sort=-%mem | head -n 10 | awk '{print $1, $2, $3, $4, $11}'

# рд╕рдХреНрд░рд┐рдп рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рди
echo "-------------------------"
echo "ЁЯФЧ рд╕рдХреНрд░рд┐рдп рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рди:"
ss -tuln | head -n 10

# рдбрд┐рд╕реНрдХ I/O рд╕реНрдЯреИрдЯреНрд╕
echo "-------------------------"
echo "ЁЯУК рдбрд┐рд╕реНрдХ I/O рд╕реНрдЯреИрдЯреНрд╕:"
iostat -xz 1 3 | awk 'NR==4 || /Device:/ || /sda/'

# рд╕рд┐рд╕реНрдЯрдо рд▓реЙрдЧреНрд╕
#echo "-------------------------"
#echo "ЁЯУЭ рд╕рд┐рд╕реНрдЯрдо рд▓реЙрдЧреНрд╕ (рдЕрдВрддрд┐рдо 10 рд▓рд╛рдЗрдиреЗрдВ):"
#tail -n 10 /var/log/syslog | grep -v "kernel"
